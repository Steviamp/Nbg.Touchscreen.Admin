@page "/forgot-password"
@rendermode InteractiveServer
@using MudBlazor
@inject NavigationManager Nav

<MudContainer MaxWidth="MaxWidth.ExtraSmall" Class="mt-10">
    <MudPaper Class="pa-6">
        <MudText Typo="Typo.h5" GutterBottom>Forgot password</MudText>

        @if (_status == "ok")
        {
            <MudAlert Severity="Severity.Success" Class="mb-3">
                If the email exists, a reset link has been sent.
            </MudAlert>
        }
        else if (_status == "invalid")
        {
            <MudAlert Severity="Severity.Error" Class="mb-3">
                Invalid email format.
            </MudAlert>
        }

        <form method="post" action="/auth/forgot-password">
            <AntiforgeryToken />
            <MudTextField @bind-Value="_email"
                          Label="Email"
                          Name="Email"
                          Required="true"
                          Variant="Variant.Outlined"
                          Class="mb-3" />

            <MudButton Variant="Variant.Filled" ButtonType="ButtonType.Submit">
                Send reset link
            </MudButton>
        </form>
    </MudPaper>
</MudContainer>

@code {
    private string _email = "";
    private string? _status;

    protected override void OnInitialized()
    {
        var uri = new Uri(Nav.Uri);
        var qs = System.Web.HttpUtility.ParseQueryString(uri.Query);
        _status = qs["status"];
    }
}

